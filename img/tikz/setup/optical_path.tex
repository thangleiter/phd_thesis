\begin{tikzpicture}[
    scale=2,%
    font=\footnotesize,%
    thick,%
    symmetryaxis/.style = {RWTHblack50,thin,dash dot},%
    lens/.style = {thick,<->},%
    optics/.style = {thick,black},%
    window/.style = {RWTHblue75,fill=RWTHblue25,text=black,opacity=0.75},%
    cryostat/.style = {RWTHblack75,thin,text=black},%
    midarrow1/.style = {postaction=decorate, decoration={markings,mark=at position 0.15 with \arrow{stealth}}},%
    midarrow2/.style = {postaction=decorate, decoration={markings,mark=at position 0.85 with \arrow{stealth}}},%
    midarrow/.style = {midarrow1, midarrow2},%
]    % requires libraries angle,quotes,calc,decorations.markings

    \ifdefined\ca
    \else
        \newlength\ca
    \fi
    \ifdefined\f
    \else
        \newlength\f
    \fi
    \ifdefined\dx
    \else
        \newlength\dx
    \fi
    \setlength\ca{0.25cm}
    \setlength\f{0.4cm}
    \setlength\dx{0.25cm}

    \coordinate (origin) at (0, 0);
    \coordinate (bs1) at (0, 0);
    \coordinate (bs2) at (0, -1);
    \coordinate (window) at ($(bs2) + (0, -0.8)$);
    \coordinate (objective) at ($(window) + (0, -1.5)$);

    \coordinate (detection-halfwave) at ($(bs1) + (0, 0.6)$);
    \coordinate (analyzer) at ($(detection-halfwave) + (0, 1*\dx)$);
    \coordinate (detection-ocular) at ($(detection-halfwave) + (0, 2*\dx)$);

    \coordinate (quarterwave) at ($(bs1) + (0.6, 0)$);
    \coordinate (excitation-halfwave) at ($(quarterwave) + (1*\dx, 0)$);
    \coordinate (polarizer) at ($(quarterwave) + (2*\dx, 0)$);
    \coordinate (excitation-ocular) at ($(quarterwave) + (3*\dx, 0)$);

    \coordinate (cmos-ocular) at ($(bs2) + (0.6, 0) + (3*\dx, 0)$);

    \coordinate (source) at ($(objective) - (0, \f)$);
    \coordinate (detection-fiber) at ($(detection-ocular) + (0, \f)$);
    \coordinate (excitation-fiber) at ($(excitation-ocular) + (\f, 0)$);
    \coordinate (cmos) at ($(cmos-ocular) + (\f, 0)$);

    % Symmetry axes
    \draw[symmetryaxis]
        ($(bs1) - (\ca*2,0)$)
        -- ($(excitation-fiber) + (\f/4,0)$)
    ;
    \draw[symmetryaxis]
        ($(bs2) - (\ca*2,0)$)
        -- ($(cmos) + (\f/4,0)$)
    ;
    \draw[symmetryaxis]
        ($(source) - (0, \f/4)$)
        -- ($(detection-fiber) + (0, \f/4)$)
    ;

    % Cryostat
    \draw[cryostat]
        ($(window) - (1.5*\ca, -0.025)$)
        -- ++($(-\f/2, 0)$)
        -- ($(source) - (1.5*\ca + \f/2, \f/2)$)
        -- ++($(3*\ca + \f, 0)$)
        -- ($(window) + (1.5*\ca + \f/2, 0.025)$) node[below,midway,rotate=90,xshift=5mm] {Cryostat}
        -- ++($(-\f/2, 0)$)
    ;

    % Beamsplitters
    \draw
        ($(bs1) - (1.5*\ca, 1.5*\ca)$) node[below left,xshift=2.1mm] {\acrshort{bs}1}
        -- ++($(3*\ca, 3*\ca)$)
    ;
    \draw[dashed]
        ($(bs2) - (1.5*\ca, 1.5*\ca)$) node[below left,xshift=2.1mm] {\acrshort{bs}2}
        -- ++($(3*\ca, 3*\ca)$)
    ;

    % Lenses
    \draw[lens]
        ($(objective) - (1.5\ca, 0)$)
        -- ++($(3*\ca, 0)$) node[right] {O}
    ;
    \draw[lens]
        ($(detection-ocular) - (1.5\ca, 0)$)
        -- ++($(3*\ca, 0)$) node[right] {D}
    ;
    \draw[lens]
        ($(excitation-ocular) + (0, 1.5\ca)$)
        -- ++($(0, -3*\ca)$) node[below] {E}
    ;
    \draw[lens]
        ($(cmos-ocular) + (0, 1.5\ca)$)
        -- ++($(0, -3*\ca)$) node[below] {C}
    ;

    % Optical elements
    \draw[optics,dashed]
        ($(detection-halfwave) - (1.5*\ca, 0)$)
        -- ++($(3*\ca, 0)$) node[right] {\halfwave}
    ;
    \draw[optics]
        ($(excitation-halfwave) + (0, 1.5*\ca)$)
        -- ++($(0, -3*\ca)$) node[below] {\halfwave}
    ;
    \draw[optics]
        ($(quarterwave) + (0, 1.5*\ca)$)
        -- ++($(0, -3*\ca)$) node[below] {\quarterwave}
    ;
    \draw[optics]
        ($(polarizer) + (0, 1.5*\ca)$)
        -- ++($(0, -3*\ca)$) node[below] {P}
    ;
    \draw[optics]
        ($(analyzer) - (1.5*\ca, 0)$)
        -- ++($(3*\ca, 0)$) node[right] {A}
    ;

    % Excitation beam
    \draw[midarrow,RWTHred100]
        (excitation-fiber)
        -- ++($(-\f, -\ca)$)
        -- ($(bs1) - (\ca, \ca)$)
        -- ($(-\ca, 0) + (objective)$)
        -- (source)
    ;
    % Detection beam
    \draw[midarrow,RWTHbordeaux100]
        (source)
        -- ++($(\ca, \f)$)
        -- ($(\ca, 0) + (detection-ocular)$)
        -- ++($(-\ca, \f)$)
    ;
    % CMOS beam
    \draw[midarrow1,RWTHbordeaux100,dashed]
        ($(bs2) + (\ca, \ca)$)
        -- ($(cmos-ocular) + (0, \ca)$)
        -- (cmos)
    ;

    % Windows
    \draw[window]
        ($(window) - (1.5*\ca, 0)$)
        rectangle ($(window) + (1.5*\ca, 0.05)$) %node[right] {Window}
    ;

\end{tikzpicture}
