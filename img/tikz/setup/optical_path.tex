\begin{tikzpicture}[
    scale=2,%
    font=\footnotesize,%
    thick,%
    symmetryaxis/.style = {RWTHblack50,thin,dash dot},%
    lens/.style = {thick,<->},%
    optics/.style = {thick,black},%
    window/.style = {RWTHblue75,fill=RWTHblue25,text=black,opacity=0.75},%
    cryostat/.style = {RWTHblack75,thin,text=black},%
    midarrow1/.style = {postaction=decorate, decoration={markings,mark=at position 0.18 with \arrow{stealth}}},%
    midarrow2/.style = {postaction=decorate, decoration={markings,mark=at position 0.82 with \arrow{stealth}}},%
    midarrow/.style = {midarrow1, midarrow2},%
]    % requires libraries angle,quotes,calc,decorations.markings

    \ifdefined\CA
    \else
        \newlength\CA
    \fi
    \ifdefined\f
    \else
        \newlength\f
    \fi
    \setlength\CA{0.25cm}
    \setlength\f{0.4cm}

    \coordinate (origin) at (0, 0);
    \coordinate (window) at (0, -0.8);
    \coordinate (objective) at (0, -2.5);
    \coordinate (detection-ocular) at (0, 1.1);
    \coordinate (detection-halfwave) at (0, 0.6);
    \coordinate (analyzer) at (0, 0.85);
    \coordinate (excitation-ocular) at (1.35, 0);
    \coordinate (polarizer) at (1.1, 0);
    \coordinate (excitation-halfwave) at (0.85, 0);
    \coordinate (quarterwave) at (0.6, 0);

    \coordinate (source) at ($(objective) - (0, \f)$);
    \coordinate (detection-fiber) at ($(detection-ocular) + (0, \f)$);
    \coordinate (excitation-fiber) at ($(excitation-ocular) + (\f, 0)$);

    % Symmetry axes
    \draw[symmetryaxis]
        ($(origin) - (\CA*2,0)$)
        -- ($(excitation-fiber) + (\f/4,0)$)
    ;
    \draw[symmetryaxis]
        ($(source) - (0, \f/4)$)
        -- ($(detection-fiber) + (0, \f/4)$)
    ;

    % Cryostat
    \draw[cryostat]
        ($(window) - (1.5*\CA, -0.025)$)
        -- ++($(-\f/2, 0)$)
        -- ($(source) - (1.5*\CA + \f/2, \f/2)$)
        -- ++($(3*\CA + \f, 0)$)
        -- ($(window) + (1.5*\CA + \f/2, 0.025)$) node[below,midway,rotate=90,xshift=5mm] {Cryostat}
        -- ++($(-\f/2, 0)$)
    ;

    % Beamsplitter
    \draw
        ($(origin) - (1.5*\CA, 1.5*\CA)$) node[below left,xshift=2.1mm] {\acrshort{bs}}
        -- ++($(3*\CA, 3*\CA)$)
    ;

    % Lenses
    \draw[lens]
        ($(objective) - (1.5\CA, 0)$)
        -- ++($(3*\CA, 0)$) node[right] {O}
    ;
    \draw[lens]
        ($(detection-ocular) - (1.5\CA, 0)$)
        -- ++($(3*\CA, 0)$) node[right] {D}
    ;
    \draw[lens]
        ($(excitation-ocular) + (0, 1.5\CA)$)
        -- ++($(0, -3*\CA)$) node[below] {E}
    ;

    % Optical elements
    \draw[optics,dashed]
        ($(detection-halfwave) - (1.5*\CA, 0)$)
        -- ++($(3*\CA, 0)$) node[right] {\halfwave}
    ;
    \draw[optics]
        ($(excitation-halfwave) + (0, 1.5*\CA)$)
        -- ++($(0, -3*\CA)$) node[below] {\halfwave}
    ;
    \draw[optics]
        ($(quarterwave) + (0, 1.5*\CA)$)
        -- ++($(0, -3*\CA)$) node[below] {\quarterwave}
    ;
    \draw[optics]
        ($(polarizer) + (0, 1.5*\CA)$)
        -- ++($(0, -3*\CA)$) node[below] {P}
    ;
    \draw[optics]
        ($(analyzer) - (1.5*\CA, 0)$)
        -- ++($(3*\CA, 0)$) node[right] {A}
    ;

    % Detection beam
    \draw[midarrow,RWTHbordeaux100]
        (source)
        -- ++($(\CA, \f)$)
        -- ($(\CA, 0) + (detection-ocular)$)
        -- ++($(-\CA, \f)$)
    ;

    % Excitation beam
    \draw[midarrow,RWTHred100]
        (excitation-fiber)
        -- ++($(-\f, -\CA)$)
        -- ($(origin) - (\CA, \CA)$)
        -- ($(-\CA, 0) + (objective)$)
        -- (source)
    ;

    % Windows
    \draw[window]
        ($(window) - (1.5*\CA, 0)$)
        rectangle ($(window) + (1.5*\CA, 0.05)$) %node[right] {Window}
    ;

\end{tikzpicture}
